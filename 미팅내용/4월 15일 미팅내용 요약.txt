한 시간 당 32*2*64 = 4096 크기의 채널을 맞추고 있음
데이터 크기를 하나로 보면 32*2 짜리로 됨
서브캐리어마다 별개의 데이터로 보면, 크기 64짜리로 64개 생기게 됨
user 수 만큼 data를 가질 수 있고

ex)
user 수 * scene = 6(개)(씬의 수에 따라 정해짐) * 서브캐리어별로 개별적으로 볼 떄, 서브캐리어 별로 64개의 데이터가 생성됨
서브캐리어별로 별개의 데이터로 보면 서브캐리어만큼의 데이터가 생기는 것
작은 하나의 서브캐리어(주파수 대역)에서의 채널을 예측할건지
wideband에서의 채널을 예측할건지

wideband가 아니라 개별로 보면 64만큼의 예측을 진행하면 됨

user수가 6만개인데 0이 들어간 값이 많음
대충 user 수 천개만 해도
1000*6*64=51만개의 데이터가 생기는 것
여기서 training_test를 쪼개면 됨 
scene은 많지 않아도 됨(더 많이 보려면 노트북 성능이 좋아야함)
하나하나의 dim이 4096이면(서브캐리어별로 봤기 때문에)

서브캐리어 별로 채널 예측(각각의 데이터로 보고 채널 예측 진행)
masked_pos

사전학습된 코드를 가지고 와야됨
LWM은 이미 학습이 되어있음
추가로 파인튜닝을 하려면 할 순 있지만, 이때는 마스킹을 하진 않음

LWM : 채널데이터로 사전학습된 모델
시간 혹은 주파수에 대해서 masking을 학습이 완료된 상태의 모델

그냥 가져와서 사용하면 됨(모델 학습을 할 필요 없이)
 
4개 입력으로 넣고 LWM에 넣었을 때, 다음의 한 개를 잘 학습하는지
다운스트림 태스크를 하지 않았으므로 잘 진행되진 않겠지만

그러면, 4개를 입력으로 LWM에 넣고 다음의 한 개를 학습하기 위한 파인튜닝을 진행해야함
뒤에 뭔가를 붙이던가
ㄴ masked_pos를 하는 그냥 조금 더 학습하는 것일 뿐임

입력의 출력 형태를 확인하고
Fully-connected-layer를 하나 더 붙여서 학습 시키고 출력을 확인하거나

1. LWM 모델 자체는 freezing하고 Fully-connected-layer를 하나 더 붙여서 해보기
2. LWM 모델 + (추가한)Fully connected layer을 다 같이 파인튜닝 해보거나

ㄴ 1번 방법 채택하기

LWM 코드를 보면 pretrained에서 체크포인트(사전 학습된 모델의 파라미터 값들을 불러오는 것)
모델이 성공적으로 불러와졌다

파인튜닝용 코드일 수도 있

✓ masking을 하는 건 masked 기반 사전학습을 할 때 뿐이라, LWM 코드 다시 보고 확인하기
✓ Normalized MSE 사용하기

✓ 4개짜리 넣어서 마지막 1개의 target_value 맞추기
마스킹만 안 했다고 하면 출력 자체를 맞춰주기(y = 타겟)(y^)
h = MSE(y, y^)


이 세 가지 방법 중 하나 선택하면 됨
>> 현재 보는 코드에서 masked를 없애는 방법 찾아보기
✓ 1. 학습한 건 안 건들이고, LWM은 freezing하고 출력을 fully-connected-layer을 붙여서 얘의 출력을 y^으로 보는 방법 << 현재 하는 것은 이 방법에 가까움
✓ 2. LWM은 어떤 형태로 사용할 지 모르고 사전학습 되어있으니까 원하는 출력 형태를 보이도록 학습된 풀리커넥티드레이어를 붙이는 것 << 이 방법 채택
✓ 3. 풀리커넥티를 두지만 LWM도 추가로 학습하고, 해서 두 개로 다 같이 파인튜닝해서 새로 학습 시킴. LWM을 프리징 할 필요 없이

2번째 방법사용, FC를 리니어레이어하고 리그레션 문제로 봐서 액티베이션 함수 없이 진행할 수 있음

데이터 쪼개야됨
트레이닝에 썼던 건, 테스트에 사용하면 안됨
training_data
validation_Data
test_data
분류하기

유저 수 많이 하고 서브캐리어 데이터 별도로 두면 데이터로더 사용해서 배치 사이즈 정하고, 셔플링 해주고, 트레이닝 데이터랑 테스트 데이터 나눠주고

trainging_data를 batch로 쪼개야하고 >> dataloader 사용하면 됨
이러면 성능 평가까지는 진행될 것이라 전망



-------------------------------------------------------------

추가적인 장기 프로젝트로 진행해볼만 데이터

group에서 데이터를 다른 형태로도 제공
✓ DeepSense 6G scenarios 데이터 사용
채널값만 있는 게 아니라, 카메라랑 센서가 달려서, 카메라 비전으로 어떤 게 보이는 지를 추가로 활용
추가로 활용해서 채널 예측을 더 잘하거나 이렇게 사용 가능
그것을 위한 데이터 사용 가능

레이더나 카메라를 사용했을 때 어떻게 더 학습을 잘 할 수 있을까


✓ DeepVerse 6G